<!doctype html>
<html>
<head>
<!--最好编码格式为utf-8-->
<meta charset="gb2312">
<title>{dede:field.title/}_{dede:global.cfg_webname/}</title>
<meta name="keywords" content="{dede:global.cfg_keywords/}" />
<meta name="description" content="{dede:global.cfg_description/}" />
{dede:include filename="head.htm"/}
<script>$('#11').addClass('current');</script>
 <style type="text/css">
        .reg-form {
            width: 660px;
            height: 600px;
            margin: 0 auto;
            background-color: #f8fdff;
            border: 1px solid #eeeeee;
			margin-top:20px;
        }

        .item {
            line-height: 65px;
            width: 100%;
            float: left;
        }

        .name {
            width: 120px;
            text-align: right;
            float: left;
        }

        .input {
            padding-left: 15px;
            margin-right: 15px;
            float: left;
        }

        .input input[type='text'], .input input[type='password'] {
            width: 250px;
            height: 25px;
            margin-right: 10px;
            line-height: 28px;
        }

        .submit {
             width:100px;
			height:35px;
			line-height:35px;
			vertical-align:middle;
        }

        label.error {
            color: red;
            font-size: 12px;
        }
    </style>
<section class="newsbanner"></section>
<section id="main" class="area">
	<div class="location">
		{dede:type typeid='11'}  
			<h2 class="news_t">[field:typename/]</h2>
		{/dede:type} 
	</div>
	<section class="area combox">
		<form name=""  id="register"  >
            <div class="reg-form">
                <div class="item">
                    <label class="name">账号</label>
                    <div class="input">
                        <input type="text" name="account" id="account"/>
                    </div>
                    <label class="tips"></label>
                </div>
                <div class="item">
                    <label class="name">密码</label>
                    <div class="input">
                        <input type="password" name="pswd" id="pswd"/>
                    </div>
                    <label class="tips"></label>
                </div>
                <div class="item">
                    <label class="name">确认密码</label>
                    <div class="input">
                        <input type="password" name="repswd" id="repswd"/>
                    </div>
                    <label class="tips"></label>
                </div>
                <div class="item">
                    <label class="name">真实姓名</label>
                    <div class="input">
                        <input type="text" name="name" id="name"/>
                    </div>
                    <label class="tips"></label>
                </div>
                <div class="item">
                    <label class="name">身份证号</label>
                    <div class="input">
                        <input type="text" name="idcard" id="idcard"/>
                    </div>
                </div>
                <div class="item">
                    <label class="name">手机号码</label>
                    <div class="input">
                        <input type="text" name="text" id="phone"/>
                    </div>
                    <label class="tips"></label>
                </div>
                <div class="item" style="text-align: center;">
                    <input type="submit" value="立即注册" id="reg" class="submit"/>
                </div>
            </div>
        </form>
	</section>
</section>
{dede:include filename="foot.htm"/}
<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/lib/jquery.js"></script>
<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
<script type="text/javascript">
    // 获取 cookie
    function getCookie(name)
    {
      var cookieString = document.cookie;
      var cookieArr = cookieString.split('; ');
      for (var i = 0; i < cookieArr.length; i++) {
        var tmpArr = cookieArr[i].split('=');
        if (name == tmpArr[0]) {
          return unescape(tmpArr[1]);
        }
      }
    }
    // 设置 cookie
    function setCookie(name, value)
    {
      // 获取当前时间 
      var date = new Date();
      var expireDays = 1;
      // 将date设置为 1 天以后的时间
      date.setTime(date.getTime() + expireDays * 24 * 3600 * 1000);
      // 将cookie设置为 1 天后过期 
      document.cookie = name + "=" + escape(value) + "; expire=" + date.toGMTString() + ";path=/";
    }
    
    function clearCookie(){
      var keys=document.cookie.match(/[^ =;]+(?=\=)/g);
      if (keys) {
        for (var i =  keys.length; i--;)
          document.cookie=keys[i]+'=0;expires=' + new Date( 0).toUTCString() + ';path=/';
      }
    }
    
    $(document).ready(function () {
        initVerifyRules();
        //注册操作
        $("#register").validate({
            submitHandler: function (form) {
                var getAccount=$.trim($("#account").val());
                var getpswd=$.trim($("#pswd").val());
                var getrepswd=$.trim($("#repswd").val());
                var getname=$.trim($("#name").val());
                var getidcard=$.trim($("#idcard").val());
                var getphone=$.trim($("#phone").val());
            
                var getUrl = "http://api.zzqianyou.com/Api/user/register?";
                var params = "account=" + getAccount + "&pswd=" + getpswd + "&repswd=" + getrepswd + "&name=" + getname+ "&idcard=" + getidcard+ "&phone=" + getphone;
                var commonUrl = getUrl + params;
                $.ajax({
                    type: "GET",
                    url: commonUrl,
                    dataType: 'jsonp',
                    jsonp: 'jsoncallback',
                    success: function(result) {
                      console.log(result);
                     if (0 == result.code) {
                        alert(result.result.msg);
                     }else{
                       alert("注册失败");
                     }
                    }
                });
            },
            rules: {
                account: {
                    required: true,
                    chrnum: true,
                },
                pswd: "required",
                repswd: {
                    required: true,
                    equalTo: "#pswd",
                },
                name: {
                    required: true,
                    chcharacter: true,
                },
                idcard: {
                    required: true,
                    isIdCardNo: true,
                },
                phone: {
                    required: true,
                    isMobile: true,
                },
            },
            messages: {
                account: {
                    required: "请输入注册账号",
                },
                pswd: "请输入密码",
                repswd: {
                    required: "请输入密码",
                    equalTo: "两次密码输入不一致"
                },
                name: {
                    required: "请输入真实姓名",
                },
                idcard: {
                    required: "请输入身份证号"
                },
                phone: {
                    required: "请输入手机号码",
                },
            },
        });
    });
    function initVerifyRules() {
        // 身份证号码验证
        jQuery.validator.addMethod("isIdCardNo", function (value, element) {
            return this.optional(element) || isIdCardNos(value);
        }, "请输入正确的身份证号码");
        //数字和字母组合
        jQuery.validator.addMethod("chrnum", function (value, element) {
            var chrnum = /^([a-zA-Z0-9]+)$/;
            return this.optional(element) || (chrnum.test(value));
        }, "只能输入数字和字母(字符A-Z, a-z, 0-9)");
        // 手机号码验证
        jQuery.validator.addMethod("isMobile", function (value, element) {
            var length = value.length;
            var mobile = /^(13[0-9]{9})|(18[0-9]{9})|(14[0-9]{9})|(17[0-9]{9})|(15[0-9]{9})$/;
            return this.optional(element) || (length == 11 && mobile.test(value));
        }, "请正确填写您的手机号码");
        // 汉字
        jQuery.validator.addMethod("chcharacter", function (value, element) {
            var tel = /^[\u0391-\uFFE5]+$/;
            return this.optional(element) || (tel.test(value));
        }, "请输入汉字");
    }

    //身份证号码的验证规则
    function isIdCardNos(num) {
        var len = num.length, re;
        if (len == 15)
            re = new RegExp(/^(\d{6})()?(\d{2})(\d{2})(\d{2})(\d{2})(\w)$/);
        else if (len == 18)
            re = new RegExp(/^(\d{6})()?(\d{4})(\d{2})(\d{2})(\d{3})(\w)$/);
        else {
            return false;
        }
        var a = num.match(re);
        if (a != null) {
            if (len == 15) {
                var D = new Date("19" + a[3] + "/" + a[4] + "/" + a[5]);
                var B = D.getYear() == a[3] && (D.getMonth() + 1) == a[4] && D.getDate() == a[5];
            }
            else {
                var D = new Date(a[3] + "/" + a[4] + "/" + a[5]);
                var B = D.getFullYear() == a[3] && (D.getMonth() + 1) == a[4] && D.getDate() == a[5];
            }
            if (!B) {
                return false;
            }
        }
        if (!re.test(num)) {
            return false;
        }
        return true;
    }
</script>
</body>
</html>
